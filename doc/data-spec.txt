                     TorBEL Export Data Format Specifications

Author: Harry Bock
Created: 26-May-2010
Status: Draft

0. Scope

  This document describes the data formats available for export from the
  Tor Bulk Exit List (TorBEL) suite.

  This document is a work-in-progress and the data format may change quickly
  during the summer in response to demand and implementation problems.

1. Formats

1.1. Baseline

  The following data are crucial to consumers of the bulk exit node list,
  with a brief rationale as to why they need this data:

    * ExitAddress: IP address from which traffic actually exits.
                   This may differ from what is advertised in the node's
                   descriptor, likely due to router misconfiguration.
    * LastTestedTimestamp: Date and time when TorBEL last completed testing
                           this node's exit policy.
    * ExitPolicy: Exit policy as advertised by the node.
    * FailedPorts: A list of ports that are advertised as open by the
                   router's ExitPolicy but were not reachable when
                   tested by TorBEL.

  The following data are supplied for convenience to the consumer:

    * RouterID: Advertised ID of the router.  Allows the consumer to
                discover more information about the router with a given
		ExitAddress.
    * InConsensus: A boolean value indicating that this node is in the
                   current consensus advertised by the Tor directory
		   authorities.  TorBEL often receives information about
		   new routers before they are voted on in the consensus.

1.2. CSV

  The simplest bulk output format supported by TorBEL is CSV  (comma-separated 
  values).  Since CSV is not a standard and many fragmented versions exist, 
  we standardize on the format as written and understood by Microsoft Excel
  and OpenOffice.
  This format is generated by the Python (>= 2.3) module 'csv' and is
  guaranteed to be readable via that module.

  The fields of each row are as follows:

    ExitAddress, RouterID, LastTestedTimestamp, InConsensus, ExitPolicy, FailedPorts

  Formats for specific fields are:

    * ExitAddress: IPv4 or IPv6 address in raw integer format.
    * RouterID: Hex string.
    * LastTestedTimestamp: Integer time in UNIX-epoch format.
    * InConsensus: "True" or "False".
    * ExitPolicy: Semicolon-separated list of ExitPolicy lines.
    * FailedPorts: List of ports, comma-separated and surrounded by square brackets.

  This data may be exported in raw or gzipped format.
